<link rel="import" href="../../polymer/polymer.html">
<link rel="import" href="../particle-party.html">


<dom-module id="particle-party-demo">
  <template>
    <style>
      .particle-repeater{
          display: flex;
          align-items: center;
          justify-content: center;
      }
      @keyframes tremble {
          0% {margin-left: -2px; margin-top: 2px;}
          50% {margin-left: 2px; margin-top: -2px}
          100% {margin-left: -2px;margin-top: 0px;}
      }
      particle-party{
            width: 20px;
            height: 20px;
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50px;
            background-color: #ffea44;
            transition: all 300ms cubic-bezier(0.390, 0.575, 0.565, 1.000);
            animation: tremble 100ms infinite;
      }
      particle-party.burst{
          width: 0;
          height: 0;
          transition: none;
          animation: none;
      }
    </style>

    <div class="particle-repeater">
        <particle-party></particle-party>
    </div>



  </template>

  <script>
    Polymer({
        is: "particle-party-demo",
        fireEvent: function(fav) {
            console.log('firing up the particle party');
        },
        attached: function() {
            var childElement = Polymer.dom(this.root).querySelector('particle-party');

            function playSequence(_this){
                // childElement.setAttribute('number-particles', Math.floor(Math.random()*50));
                // childElement.setAttribute('gravity', Math.random() * 0.4 + 0.1);
                // childElement.setAttribute('particle-decay', Math.random()*0.04);
                childElement.setAttribute('number-particles', 30);
                childElement.setAttribute('gravity', .2);
                childElement.setAttribute('particle-decay', 0.01);

                setTimeout(function(){
                    _this.$$('particle-party').toggleClass('burst');
                    childElement.fire('fireAnimation');
                }.bind(_this), 800);
                setTimeout(function(){
                    _this.$$('particle-party').toggleClass('burst');
                }.bind(_this), 1200);
            };
            playSequence(this);
            setInterval(function(){
                playSequence(this);
            }.bind(this), 1200)
        },
    });
  </script>
</dom-module>
